---
layout : post
category : programming language
tags : [Programming language]
---

# 编程语言原理(第10版)  


## 第6章 数据类型

### 6.1 概述

*  数据类型定义了一组数据值，以及在这些数据值上预先定义的一组操作。
*  抽象数据类型的基本思想是分离类型的接口（它对用户是可见的）与该类型的数据表示和操作集（这两者对用户是隐藏的）
*  结构化数据类型由**类型操作符**或**构造符**来定义，用于形成类型表达式。
	* 例如， C语言用方括号和星号作为类型操作符，来指明数组和指针。
*  **描述符**是变量的一组属性集合。在实现中，描述符是存储变量属性的一个内存区域。
	* 如果这些属性都是静态的，那么这些描述符只在编译期间才需要。它们由编译器创建，通常是作为符号表的一部分，并用于编译期间。
	* 对于动态属性，描述符的一部分或全部则必须在执行期间维护。在这种情况下，描述符由运行时系统使用
	* 在所有情况下，描述符都用于类型检查，以及生成内存分配和释放操作的代码
* 使用术语**“变量”**时要小心。只使用传统命令式语言的人可能把标识符看作变量，但在考虑数据类型时，这可能带来混淆。在一些编程语言中，标识符没有数据类型，所以最好记住，**标识符**只是**变量**的一个**属性**。 
* **对象**这个词常和变量的值以及变量占的空间联系在一起。对象只是用户定义的抽象数据类型的**实例** 。在面向对象语言中，每个类的实例，都称为对象。
*  数据类型的基本设计问题：
	* 应该为类型的变量提供哪些操作？
	* 如何说明这些操作？

### 6.2 基本数据类型

*  不用其他数据类型来定义的数据类型称为基本数据类型。

#### 6.2.1 数值类型

##### 6.2.1.1 整数

*  大多数整数类型是硬件直接支持的。
* 硬件不直接支持的一种整数类型是 Python 中的 long integer类型
*  关于整数表示方法的细节信息，请参阅任何一本关于汇编语言程序设计的书籍

##### 6.2.1.2 浮点数

* 浮点数据类型模拟实数，但浮点数表示的只是大多数实数值的近似值。
* 关于浮点表示法的详细信息，请参阅任何一本关于数值分析的书。
*  两种浮点类型 IEEE浮点标准 754
	* float 通常四个内存字节 (1符号位 8 指数位 23 小数位)
	* double 通常存储空间是float变量的两倍，并提供至少两倍的小数位数 （1符号位 11 指数位 52 小数位）
* 精度和范围定义了能用浮点性表示的数值集合。
	* 精度是数值小数部分的准确性，用小数位数来衡量
	* 范围则是指小数范围和指数范围的组合，在这里，指数范围更重要

##### 6.2.1.3 复数

*  复数值用浮点值的有序对来表示
	* Fortran 和Python

##### 6.2.1.4 小数

* 大多数为支持商业系统应用而设计的大型计算机都为小数数据类型提供硬件支持
*  小数数据类型存储固定数目的小数位，小数点位于数值中的一个固定位置上。
* 小数类型的优势在于它至少能在有限的范围内精确存储小数数值。这是浮点数做不到的。
* 缺点是：
	* 由于不允许使用指数，所以它们表示的数值范围是受限的  
	* 它们在内存中的表示很浪费空间
		* 使用二进制码来表示十进制数字。二进制编码的十进制数（binary coded decimal BCD）

#### 6.2.2 布尔类型 

*  布尔类型或许是所有类型中最简单的类型，这种类型的取值范围只有两个元素：一个为真，一个为假。
*  C89 数值表达式用作条件，非零为真，零为假
*  C99 和 C++ 有布尔类型，但同时允许数值表达式用作布尔型
*  Java和C#语言中不允许这样

#### 6.2.3 字符类型

* 字符数据以数值编码的形式存储在计算机中。
	* ASCII 
	* Unicode 
	* UTF-32   

### 6.3 字符串类型

*  字符串类型的值由字符序列组成

#### 6.3.1 设计问题

*  两个最重要设计问题：
	* 字符串应该是一种特殊的字符数组，还是一种基本类型？
	* 字符串应该具有静态长度，还是动态长度？

#### 6.3.2 字符串及其操作

*  最常用的字符串操作包括赋值、拼接、子串引用、比较以及模式匹配。
*  如果字符串没有定义为基本类型，则字符串数据通常储存在字符数组中，并以字符数组的形式引用。
*  C和C++采用char数组来存储字符串。约定字符串由一个特殊的字符null来终止，null用0表示。
*  在Java中，字符串由String类(值是常量字符串)和StringBuffer类(值是可变的，更像字符数组)来支持。
*  C#和Ruby包含的字符串类与Java相似
*  Python 也把字符串作为基本类型，然而Python字符串是不可变的
*  F#中，字符串是一个类。
* Perl、 JavaScript、 Ruby、 PHP包含内置的模式匹配操作。
	* 模式匹配表达式在一定程度上近似基于数学表达式，常称为**正则表达式**。
*  C++ Java Python C# 和F#的类库中包含了用正则表达式匹配模式的功能

#### 6.3.3 字符串长度的设计选项

*  几种设计选择
	*  长度是静态的，在创建字符串时设置，静态长度字符串
		* Python 、Java中的string、C++标准库中类似的类、Ruby 的内置String类，以及C#和F#中的.NET类库
	*  允许字符串具有可变的长度，其上限是由变量定义所设定的一个固定的最大值。动态限长字符串。
		* C中的字符串和C++中C风格的字符串
	* 允许字符串具有可变的长度，且不设上限，动态长度字符串。
		* JavaScript、Perl和C++标准库

#### 6.3.4 评价

#### 6.3.5 字符串类型的实现

*  静态字符串类型的描述符有三个字段，它只在编译过程中需要用到。
	* 第一个字段是类型的名称
	* 第二个字段是它的长度
	* 第三个字段是首字符的地址
*  动态限长字符串描述符
	* 类型名称
	* 最大长度
	* 当前长度
	* 地址
* 动态长度字符串描述符
	* 类型名称
	* 当前长度
	* 地址	 
* 描述符大多数情况下是存储在符号表中
*  C和C++的动态限长字符串不需要运行时描述符，因为这种字符串用null字符来标记结尾。它们也不需要最大长度信息，因为在这两种语言中，没有对数组下标的值进行范围检查。
*  静态长度和动态限长字符串不要求特殊的动态存储分配。
	* 动态限长字符串，当字符串变量与存储空间绑定时，已经为最大长度分配了足够的存储空间。
* 动态长度字符串的动态分配和释放
	* 字符串存储在链表里
	* 字符串以指针数组的形式存储   
	*  将完整的字符串存在相邻的存储空间中


### 6.4 用户定义的叙述类型

#### 6.4.1 枚举类型

#### 6.4.2 子界类型

#### 6.4.3 实现用户定义的有序类型

### 6.5 数组类型

#### 6.5.1 设计问题

#### 6.5.2 数组和索引

#### 6.5.3 下标的绑定和数组的种类

#### 6.5.4 数组的初始化

#### 6.5.5 数组操作

#### 6.5.6 矩形数组和不规则数组

#### 6.5.7 切片

#### 6.5.8 评价

#### 6.5.9 数组类型的实现

### 6.6 关联类型

#### 6.6.1 结构和操作

#### 6.6.2 关联数组的实现

### 6.7 记录类型

#### 6.7.1 记录的意义

#### 6.7.2 记录域的引用

#### 6.7.3 评价

#### 6.7.4 记录类型的实现

### 6.8 元祖类型

### 6.9 列表类型

### 6.10 联合类型

#### 6.10.1 设计问题

#### 6.10.2 判别式联合与自由联合

#### 6.10.3 Ada的联合类型

#### 6.10.4 F#的联合类型

#### 6.10.5 评价

#### 6.10.6 联合类型的实现

### 6.11 指针和引用类型

#### 6.11.1 设计问题

#### 6.11.2 指针操作

#### 6.11.3 指针的相关问题

#### 6.11.4 Ada中的指针

#### 6.11.5 C 和 C++ 中的指针

#### 6.11.6 引用类型

#### 6.11.7 评价

#### 6.11.8 指针和引用类型的实现

### 6.12 类型检查

### 6.13 类型强化

### 6.14 类型等价

### 6.15 理论和数据类型
